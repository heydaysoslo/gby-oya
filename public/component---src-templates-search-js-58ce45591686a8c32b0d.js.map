{"version":3,"sources":["webpack:///./src/components/PostLoadButton.js","webpack:///./src/components/Search.js","webpack:///./src/components/SearchContainer.js","webpack:///./src/templates/search.js"],"names":["PostLoadButton","render","react_default","a","createElement","className","disabled","this","props","loading","onClick","loadMore","index_es","id","defaultMessage","Component","Search","_this$props","input","query","actions","results","resultTotal","submitted","currentPage","totalPages","onSubmit","submitHandler","type","clearSearch","placeholder","name","ref","value","onChange","handleChange","values","queryString","utils","length","map","item","key","gatsby_browser_entry","to","link","content","title","rendered","excerpt","featured_image","hoverable","Object","assign","maxWidth","PostLoadButton_PostLoadButton","cleanSearch","str","SearchContainer","createRef","state","page","componentDidMount","_this","inputFocusTimer","setTimeout","current","focus","setState","search","componentWillUnmount","clearTimeout","e","target","preventDefault","handleSearch","meta","current_page","newState","fetch","then","response","json","res","prevState","concat","_toConsumableArray","catch","err","_this$state","result_total","total_pages","Search_Search","__webpack_require__","d","__webpack_exports__","pageQuery","_ref","data","pageContext","locale","translations","layout","options","wordpressHeyAcfoptions","settings","wordpressHeySettings","components_SearchContainer"],"mappings":"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","file":"component---src-templates-search-js-58ce45591686a8c32b0d.js","sourcesContent":["import React, { Component } from \"react\"\nimport { FormattedMessage } from \"react-intl\"\n\nexport default class PostLoadButton extends Component {\n  render() {\n    return (\n      <div className=\"BlogPage__action\">\n        <button\n          disabled={this.props.loading}\n          className=\"button\"\n          onClick={this.props.loadMore}\n        >\n          {this.props.loading ? (\n            <FormattedMessage id=\"button.loading\" defaultMessage=\"Loading\" />\n          ) : (\n            <FormattedMessage id=\"button.loadMore\" defaultMessage=\"Load more\" />\n          )}\n        </button>\n      </div>\n    )\n  }\n}\n","import React, { Component } from \"react\"\nimport { Link } from \"gatsby\"\n\nimport { FeaturedImageAspect, Overlay, Html, Loader } from \"./utils\"\nimport PostLoadButton from \"./PostLoadButton\"\nimport { FormattedMessage } from \"react-intl\"\n\nexport default class Search extends Component {\n  render() {\n    const {\n      input,\n      query,\n      actions,\n      results,\n      resultTotal,\n      loading,\n      submitted,\n      currentPage,\n      totalPages,\n    } = this.props\n    return (\n      <div className=\"Search\">\n        <header className=\"Search__header\">\n          <form className=\"Search__form\" onSubmit={actions.submitHandler}>\n            <div className=\"Search__input-wrapper\">\n              {query && (\n                <button\n                  className=\"Search__clear\"\n                  type=\"button\"\n                  onClick={actions.clearSearch}\n                >\n                  &times;\n                </button>\n              )}\n              <FormattedMessage\n                id=\"search.placeholder\"\n                defaultMessage=\"SÃ¸k her\"\n              >\n                {placeholder => (\n                  <input\n                    name=\"search\"\n                    className=\"Search__input\"\n                    ref={input}\n                    type=\"text\"\n                    value={query}\n                    onChange={actions.handleChange}\n                    placeholder={placeholder}\n                  />\n                )}\n              </FormattedMessage>\n            </div>\n            {/* the submit button enables native submitting on enter */}\n            <button className=\"Search__submit button\" type=\"submit\" value=\"\">\n              <FormattedMessage id=\"search.submit\" defaultMessage=\"Search\" />\n            </button>\n          </form>\n          {loading && (\n            <div>\n              <FormattedMessage\n                id=\"search.searching\"\n                defaultMessage={`Searching for \"{queryString}\"`}\n                values={{ queryString: submitted }}\n              />\n              <Loader />\n            </div>\n          )}\n          {results.length > 0 && (\n            <p>\n              <FormattedMessage\n                id=\"search.results\"\n                defaultMessage={`Found {resultTotal} results for \"{queryString}\"`}\n                values={{ resultTotal, queryString: submitted }}\n              />\n            </p>\n          )}\n        </header>\n        {results.length > 0 && (\n          <div className=\"SearchResults\">\n            {results.map(item => (\n              <div className=\"SearchResults__item\" key={item.id}>\n                <Link className=\"SearchResults__link\" to={item.link}>\n                  <div className=\"SearchResults__content\">\n                    <h3 className=\"SearchResults__title\">\n                      <Html content={item.title.rendered} />\n                    </h3>\n                    {item.excerpt && (\n                      <div className=\"SearchResults__excerpt\">\n                        <Html content={item.excerpt.rendered} />\n                      </div>\n                    )}\n                  </div>\n                  {item.featured_image && (\n                    <div className=\"SearchResults__media\">\n                      <Overlay hoverable>\n                        <FeaturedImageAspect\n                          className=\"SearchResults__image aspect-sm--square\"\n                          {...item.featured_image}\n                          maxWidth={300}\n                        />\n                      </Overlay>\n                    </div>\n                  )}\n                </Link>\n              </div>\n            ))}\n            {currentPage && totalPages && currentPage < totalPages && (\n              <PostLoadButton loadMore={actions.loadMore} loading={loading} />\n            )}\n          </div>\n        )}\n        {query && results && results.length === 0 && !loading && submitted && (\n          <div className=\"Search__no-hits\">\n            <h2 className=\"Search__title\">\n              <FormattedMessage\n                id=\"search.noresults\"\n                defaultMessage={`Sorry, no results for \"{queryString}\"`}\n                values={{ queryString: submitted }}\n              />\n            </h2>\n            <button className=\"button\" onClick={actions.clearSearch}>\n              <FormattedMessage\n                id=\"search.noresultsMessage\"\n                defaultMessage={`PrÃ¸v en annen sÃ¸keterm`}\n              />\n            </button>\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n","import React, { Component, createRef } from \"react\"\nimport Search from \"./Search\"\n\nconst cleanSearch = str => {\n  return str //str.replace(/[^a-zA-Z0-9\\-_+ ]/g, '')\n}\n\nclass SearchContainer extends Component {\n  input = createRef()\n\n  state = {\n    query: \"\",\n    results: [],\n    loading: false,\n    submitted: false,\n    page: null,\n  }\n\n  componentDidMount = () => {\n    this.inputFocusTimer = setTimeout(() => {\n      this.input.current.focus()\n    }, 300)\n\n    // Search on initial load based on query\n    // if (this.props.match.params && this.props.match.params.query) {\n    //   this.setState({ query: this.props.match.params.query }, () => {\n    //     this.search()\n    //   })\n    // }\n  }\n\n  clearSearch = () => {\n    this.setState({ query: \"\" }, () => {\n      this.search()\n      this.input.current.focus()\n    })\n  }\n\n  componentWillUnmount = () => {\n    if (this.inputFocusTimer) {\n      clearTimeout(this.inputFocusTimer)\n    }\n  }\n\n  handleChange = e => {\n    this.setState({\n      query: e.target.value,\n    })\n  }\n\n  submitHandler = e => {\n    e.preventDefault()\n    this.handleSearch()\n  }\n\n  handleSearch = () => {\n    this.search()\n  }\n\n  loadMore = () => {\n    this.search(this.state.meta.current_page + 1)\n  }\n\n  search = (page = 1) => {\n    const query = cleanSearch(this.state.query)\n    if (!query) {\n      this.setState({\n        loading: false,\n        query: \"\",\n        results: [],\n        submitted: false,\n      })\n\n      // this.props.history.replace('/search/', {})\n    } else {\n      let newState = {\n        loading: true,\n      }\n      if (this.state.query !== this.state.submitted) {\n        newState.submitted = this.state.query\n        newState.results = []\n      }\n\n      this.setState(newState)\n\n      fetch(\n        `https://api.oyafestivalen.no/wp-json/hey/v1/search?s=${query}&page=${page}`\n      )\n        .then(response => response.json())\n        .then(res => {\n          this.setState(\n            prevState => ({\n              results:\n                page === 1\n                  ? res.results\n                  : [...prevState.results, ...res.results],\n              meta: res.meta,\n              loading: false,\n            }),\n            () => {\n              // Add url parameter for successful search to make it possible to share results\n              // this.props.history.replace('/search/' + query, {})\n            }\n          )\n        })\n        .catch(err => {\n          this.setState({\n            loading: false,\n            results: [],\n          })\n        })\n    }\n  }\n\n  render() {\n    const { query, results, meta, loading, submitted } = this.state\n\n    const props = {\n      query,\n      results,\n      resultTotal: (meta && meta.result_total) || 0,\n      currentPage: (meta && meta.current_page) || 0,\n      totalPages: (meta && meta.total_pages) || 0,\n      loading,\n      input: this.input,\n      submitted,\n    }\n\n    const actions = {\n      clearSearch: this.clearSearch,\n      handleChange: this.handleChange,\n      loadMore: this.loadMore,\n      submitHandler: this.submitHandler,\n    }\n\n    return (\n      <article className=\"Page\">\n        <Search actions={actions} {...props} />\n      </article>\n    )\n  }\n}\n\nexport default SearchContainer\n","import React from \"react\"\nimport { graphql } from \"gatsby\"\nimport Layout from \"../components/layout\"\nimport SearchContainer from \"../components/SearchContainer\"\n\nexport default ({ data, pageContext }) => {\n  const { locale, translations } = pageContext\n  return (\n    <Layout\n      locale={locale}\n      translations={translations}\n      options={data.wordpressHeyAcfoptions}\n      settings={data.wordpressHeySettings}\n    >\n      <article className=\"Page\">\n        <SearchContainer locale={locale} />\n      </article>\n    </Layout>\n  )\n}\n\nexport const pageQuery = graphql`\n  query($locale: String!) {\n    wordpressHeyAcfoptions(locale: { eq: $locale }) {\n      locale\n      options {\n        url_app_download_android\n        url_app_download_ios\n        tickets_button_text\n        tickets_sold_out\n        tickets_url\n        partners_main {\n          title {\n            rendered\n          }\n        }\n      }\n    }\n\n    wordpressHeySettings(locale: { eq: $locale }) {\n      locale\n      page_for_posts {\n        wordpress_id\n      }\n    }\n  }\n`\n"],"sourceRoot":""}